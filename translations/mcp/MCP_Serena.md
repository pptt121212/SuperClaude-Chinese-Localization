# Serena MCP服务器

**目的**: 具有项目记忆和会话持久性的语义代码理解

## 触发器
- 符号操作：重命名、提取、移动函数/类
- 项目范围的代码导航和探索
- 需要LSP集成的多语言项目
- 会话生命周期：`/sc:load`、`/sc:save`、项目激活
- 内存驱动开发工作流程
- 大型代码库分析（>50个文件，复杂架构）

## 选择时机
- **优于Morphllm**: 用于符号操作，而非基于模式的编辑
- **对于语义理解**: 符号引用、依赖跟踪、LSP集成
- **对于会话持久性**: 项目上下文、内存管理、跨会话学习
- **对于大型项目**: 需要架构理解的多语言代码库
- **不用于简单编辑**: 基本文本替换、样式强制、批量操作

## 最佳配合
- **Morphllm**: Serena分析语义上下文 → Morphllm执行精确编辑
- **Sequential**: Serena提供项目上下文 → Sequential执行架构分析

## 示例
```
"rename function across all files" → Serena (符号重命名)
"find all references to this class" → Serena (引用查找)
"extract method to utility file" → Serena (方法提取)
"analyze project architecture" → Serena (架构分析)
```

## 主要功能
- **符号操作**: 精确的代码重构和导航
- **语义理解**: 深度代码分析和关系映射
- **项目记忆**: 跨会话的项目上下文持久性
- **LSP集成**: 语言服务器协议功能
- **多语言支持**: 跨不同编程语言的代码理解

## 符号操作能力
### 重构操作
- 函数和方法重命名
- 类和接口重命名
- 变量和常量重命名
- 文件和模块重命名

### 提取操作
- 方法提取到实用程序文件
- 接口提取到独立文件
- 常量提取到配置文件
- 组件提取到库文件

### 移动操作
- 在文件之间移动函数
- 重新组织类结构
- 合并和拆分模块
- 重构目录结构

## 语义理解功能
### 依赖分析
- 导入/导出关系映射
- 模块依赖图生成
- 循环依赖检测
- 架构影响分析

### 代码导航
- 符号定义查找
- 引用位置定位
- 调用层次结构
- 继承层次分析

## 项目记忆系统
### 会话持久性
- 项目状态保存和恢复
- 工作上下文维护
- 任务进度跟踪
- 学习和适应

### 内存管理
- 项目知识存储
- 代码模式识别
- 用户偏好学习
- 历史决策记录

## 使用场景
### 大型重构项目
```
需求: 重构大型代码库
使用: Serena进行符号操作和语义分析
结果: 安全、准确的重构
```

### 代码库探索
```
需求: 理解复杂项目架构
使用: Serena分析依赖和关系
结果: 全面的项目理解
```

### 跨会话开发
```
需求: 长期项目开发
使用: Serena维护项目记忆
结果: 连贯的开发体验
```

## 优势
- **精确性**: 准确的符号操作和理解
- **持久性**: 跨会话的项目上下文
- **智能性**: 深度语义理解和分析
- **可扩展性**: 适用于大型代码库
- **多语言**: 支持多种编程语言

## 局限性
- 不适合简单的文本编辑
- 依赖结构化的代码信息
- 对于小项目可能过于复杂
- 需要准确的符号信息

## 与其他MCP服务器的比较
- **vs Morphllm**: 语义理解vs模式编辑
- **vs Context7**: 项目知识vs文档查找
- **vs Sequential**: 代码理解vs推理分析

## 典型工作流程
1. 激活项目会话或加载现有会话
2. 使用Serena分析项目结构和依赖关系
3. 执行符号操作或代码重构
4. 验证更改并更新项目记忆
5. 定期保存项目状态以供将来使用